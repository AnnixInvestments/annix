#!/bin/bash

set -e

ROOT_DIR="$(cd "$(dirname "$0")/.." && pwd)"

echo "Running pre-push checks..."

echo "Running full test suite..."
cd "$ROOT_DIR"
pnpm test:all

echo "Building backend..."
cd "$ROOT_DIR/annix-backend"
pnpm run build

echo "Running migrations..."
pnpm run migration:run

echo "Building frontend..."
cd "$ROOT_DIR/annix-frontend"
pnpm run build

echo "Pre-push checks passed!"
