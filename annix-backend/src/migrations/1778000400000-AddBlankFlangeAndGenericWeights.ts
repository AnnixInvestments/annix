import { MigrationInterface, QueryRunner } from "typeorm";

export class AddBlankFlangeAndGenericWeights1778000400000 implements MigrationInterface {
  public async up(queryRunner: QueryRunner): Promise<void> {
    const blankWeights = this.blankFlangeWeights();
    const genericWeights = this.genericFlangeWeights();

    for (const pc of Object.keys(blankWeights)) {
      const values = Object.entries(blankWeights[pc])
        .map(([nb, weight]) => `(NULL, '${pc}', 'BLANK', ${nb}, ${weight})`)
        .join(", ");
      if (values) {
        await queryRunner.query(`
          INSERT INTO flange_type_weights (flange_standard_id, pressure_class, flange_type_code, nominal_bore_mm, weight_kg)
          VALUES ${values}
        `);
      }
    }

    for (const pc of Object.keys(genericWeights)) {
      const values = Object.entries(genericWeights[pc])
        .map(([nb, weight]) => `(NULL, '${pc}', 'GENERIC', ${nb}, ${weight})`)
        .join(", ");
      if (values) {
        await queryRunner.query(`
          INSERT INTO flange_type_weights (flange_standard_id, pressure_class, flange_type_code, nominal_bore_mm, weight_kg)
          VALUES ${values}
        `);
      }
    }
  }

  public async down(queryRunner: QueryRunner): Promise<void> {
    await queryRunner.query(
      `DELETE FROM flange_type_weights WHERE flange_standard_id IS NULL AND flange_type_code IN ('BLANK', 'GENERIC')`,
    );
  }

  private blankFlangeWeights(): Record<string, Record<number, number>> {
    return {
      PN6: {
        15: 0.44,
        20: 0.59,
        25: 0.72,
        32: 1.16,
        40: 1.35,
        50: 1.9,
        65: 2.5,
        80: 3.8,
        100: 4.8,
        125: 6.0,
        150: 7.5,
        200: 11.5,
        250: 17.0,
        300: 24.0,
        350: 33.0,
        400: 43.0,
        450: 54.0,
        500: 60.0,
        600: 85.0,
        700: 115.0,
        750: 130.0,
        800: 150.0,
        900: 190.0,
        1000: 240.0,
        1200: 350.0,
      },
      PN10: {
        15: 0.67,
        20: 0.94,
        25: 1.1,
        32: 1.8,
        40: 2.1,
        50: 2.7,
        65: 3.5,
        80: 4.5,
        100: 5.8,
        125: 7.5,
        150: 10.0,
        200: 16.5,
        250: 25.0,
        300: 36.0,
        350: 48.0,
        400: 62.0,
        450: 78.0,
        500: 95.0,
        600: 135.0,
        700: 180.0,
        750: 205.0,
        800: 235.0,
        900: 300.0,
        1000: 380.0,
        1200: 560.0,
      },
      PN16: {
        15: 0.81,
        20: 1.1,
        25: 1.3,
        32: 2.2,
        40: 2.5,
        50: 3.3,
        65: 4.2,
        80: 5.4,
        100: 7.2,
        125: 10.2,
        150: 13.2,
        200: 20.0,
        250: 32.0,
        300: 48.0,
        350: 65.0,
        400: 85.0,
        450: 108.0,
        500: 135.0,
        600: 195.0,
        700: 265.0,
        750: 305.0,
        800: 350.0,
        900: 450.0,
        1000: 570.0,
        1200: 850.0,
      },
      PN25: {
        15: 0.95,
        20: 1.3,
        25: 1.5,
        32: 2.6,
        40: 3.0,
        50: 4.0,
        65: 5.5,
        80: 7.0,
        100: 9.5,
        125: 13.5,
        150: 18.0,
        200: 30.0,
        250: 48.0,
        300: 72.0,
        350: 100.0,
        400: 135.0,
        450: 175.0,
        500: 220.0,
        600: 320.0,
        700: 440.0,
        750: 510.0,
        800: 590.0,
        900: 760.0,
        1000: 970.0,
      },
      PN40: {
        15: 1.1,
        20: 1.5,
        25: 1.8,
        32: 3.0,
        40: 3.5,
        50: 4.8,
        65: 6.5,
        80: 8.5,
        100: 12.0,
        125: 17.0,
        150: 23.0,
        200: 40.0,
        250: 65.0,
        300: 100.0,
        350: 140.0,
        400: 190.0,
        450: 250.0,
        500: 320.0,
        600: 480.0,
      },
      "Class 150": {
        15: 0.7,
        20: 1.0,
        25: 1.2,
        32: 1.8,
        40: 2.2,
        50: 3.0,
        65: 4.5,
        80: 5.5,
        100: 8.0,
        125: 11.0,
        150: 15.0,
        200: 24.0,
        250: 38.0,
        300: 55.0,
        350: 75.0,
        400: 100.0,
        450: 130.0,
        500: 165.0,
        600: 240.0,
      },
      "Class 300": {
        15: 1.0,
        20: 1.5,
        25: 1.8,
        32: 2.5,
        40: 3.5,
        50: 4.5,
        65: 6.5,
        80: 8.5,
        100: 13.0,
        125: 18.0,
        150: 25.0,
        200: 42.0,
        250: 68.0,
        300: 100.0,
        350: 140.0,
        400: 190.0,
        450: 250.0,
        500: 320.0,
        600: 480.0,
      },
      "Class 600": {
        15: 1.5,
        20: 2.2,
        25: 2.8,
        32: 4.0,
        40: 5.5,
        50: 7.5,
        65: 11.0,
        80: 15.0,
        100: 22.0,
        125: 32.0,
        150: 45.0,
        200: 78.0,
        250: 130.0,
        300: 195.0,
        350: 280.0,
        400: 385.0,
        450: 510.0,
        500: 660.0,
        600: 1000.0,
      },
    };
  }

  private genericFlangeWeights(): Record<string, Record<number, number>> {
    return {
      PN6: {
        15: 0.4,
        20: 0.59,
        25: 0.72,
        32: 1.16,
        40: 1.35,
        50: 1.48,
        65: 1.86,
        80: 2.95,
        100: 3.26,
        125: 4.32,
        150: 4.76,
        200: 6.88,
        250: 8.92,
        300: 11.9,
        350: 16.8,
        400: 19.8,
        450: 24.0,
        500: 26.3,
        600: 34.7,
        700: 52.4,
        750: 62.0,
        800: 71.3,
        900: 95.0,
        1000: 125.0,
        1050: 145.0,
        1200: 200.0,
      },
      PN10: {
        15: 0.67,
        20: 0.94,
        25: 1.11,
        32: 1.82,
        40: 2.08,
        50: 2.73,
        65: 3.16,
        80: 3.6,
        100: 4.39,
        125: 5.41,
        150: 7.14,
        200: 9.27,
        250: 11.8,
        300: 13.6,
        350: 20.4,
        400: 27.5,
        450: 34.0,
        500: 40.1,
        600: 54.3,
        700: 82.8,
        750: 98.0,
        800: 116.5,
        900: 155.0,
        1000: 200.0,
        1050: 230.0,
        1200: 320.0,
      },
      PN16: {
        15: 0.67,
        20: 0.94,
        25: 1.11,
        32: 1.82,
        40: 2.08,
        50: 2.73,
        65: 3.48,
        80: 4.32,
        100: 6.07,
        125: 8.19,
        150: 10.3,
        200: 17.9,
        250: 29.3,
        300: 45.1,
        350: 66.7,
        400: 97.1,
        450: 75.0,
        500: 63.8,
        600: 101.3,
        700: 111.1,
        750: 135.0,
        800: 158.6,
        900: 210.0,
        1000: 280.0,
        1050: 330.0,
        1200: 480.0,
      },
      PN25: {
        15: 0.67,
        20: 0.94,
        25: 1.11,
        32: 1.82,
        40: 2.08,
        50: 2.73,
        65: 3.48,
        80: 4.32,
        100: 6.07,
        125: 8.19,
        150: 10.3,
        200: 17.9,
        250: 29.3,
        300: 45.1,
        350: 66.7,
        400: 97.1,
        450: 120.0,
        500: 86.7,
        600: 126.9,
        700: 193.0,
        750: 230.0,
        800: 266.3,
        900: 360.0,
        1000: 480.0,
        1050: 560.0,
        1200: 820.0,
      },
      PN40: {
        15: 0.8,
        20: 1.1,
        25: 1.3,
        32: 2.2,
        40: 2.5,
        50: 3.3,
        65: 4.2,
        80: 5.2,
        100: 7.3,
        125: 9.8,
        150: 12.4,
        200: 21.5,
        250: 35.2,
        300: 54.0,
        350: 80.0,
        400: 116.0,
        450: 145.0,
        500: 105.0,
        600: 155.0,
        700: 235.0,
        750: 280.0,
        800: 320.0,
        900: 430.0,
        1000: 580.0,
        1050: 680.0,
        1200: 1000.0,
      },
      PN64: {
        15: 1.0,
        20: 1.4,
        25: 1.6,
        32: 2.8,
        40: 3.2,
        50: 4.2,
        65: 5.4,
        80: 6.6,
        100: 9.4,
        125: 12.5,
        150: 16.0,
        200: 28.0,
        250: 45.0,
        300: 70.0,
        350: 105.0,
        400: 150.0,
        450: 190.0,
        500: 140.0,
        600: 210.0,
        700: 320.0,
        750: 380.0,
        800: 440.0,
        900: 590.0,
        1000: 800.0,
        1050: 940.0,
        1200: 1400.0,
      },
      "Class 150": {
        15: 0.5,
        20: 0.9,
        25: 0.9,
        32: 1.4,
        40: 1.4,
        50: 2.3,
        65: 3.6,
        80: 4.1,
        100: 5.9,
        125: 6.8,
        150: 8.6,
        200: 13.5,
        250: 19.4,
        300: 28.8,
        350: 40.5,
        400: 47.7,
        450: 58.5,
        500: 74.3,
        600: 99.0,
        700: 130.0,
        750: 150.0,
        800: 175.0,
        900: 230.0,
        1000: 300.0,
        1050: 350.0,
        1200: 500.0,
      },
      "Class 300": {
        15: 0.9,
        20: 1.4,
        25: 1.4,
        32: 2.0,
        40: 2.9,
        50: 3.2,
        65: 4.5,
        80: 5.9,
        100: 10.6,
        125: 13.0,
        150: 17.6,
        200: 26.1,
        250: 36.5,
        300: 51.8,
        350: 74.3,
        400: 94.5,
        450: 113.9,
        500: 141.8,
        600: 220.5,
        700: 290.0,
        750: 340.0,
        800: 400.0,
        900: 530.0,
        1000: 700.0,
        1050: 820.0,
        1200: 1200.0,
      },
      "Class 600": {
        15: 1.4,
        20: 2.0,
        25: 2.3,
        32: 3.2,
        40: 4.5,
        50: 5.0,
        65: 7.3,
        80: 9.5,
        100: 16.8,
        125: 21.0,
        150: 28.5,
        200: 45.0,
        250: 65.0,
        300: 95.0,
        350: 140.0,
        400: 185.0,
        450: 235.0,
        500: 300.0,
        600: 480.0,
        700: 650.0,
        750: 770.0,
        800: 900.0,
        900: 1200.0,
        1000: 1600.0,
        1050: 1900.0,
        1200: 2800.0,
      },
    };
  }
}
